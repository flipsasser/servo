#!/usr/bin/env ruby
require 'rubygems'
require 'optparse'
require './lib/servo'

options = {:port => 9292}

OptionParser.new do |opts|
  opts.banner = "Usage: servo [options] [directory]"

  opts.on('-p PORT', '--port PORT', 'Configure a port to run on. Default is 9292.') do |port|
    options[:port] = port.to_i
  end
end.parse!

dir  = ARGV.first && File.expand_path(ARGV.first) || Dir.pwd

server = Rack::Server.new(:Port => options[:port])
server.options[:config] = nil
server.instance_variable_set('@app', Servo.app(dir))
server.start
